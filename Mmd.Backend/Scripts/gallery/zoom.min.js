function init($) {
    var body = $('body');
    body.append('<div id="zoom"><a class="close"></a><a href="#previous" class="previous"></a><a href="#next" class="next"></a><div class="content loading"></div></div>');
    var zoom = $('#zoom').hide();
    (function bindNavigation() {
        $('#zoom').on('click', function (event) {
            event.preventDefault();
            if ($(event.target).attr('id') == 'zoom') {
                close();
            }
        });

        $('#zoom .close').on('click', close);
        $('#zoom .previous').on('click', openPrevious);
        $('#zoom .next').on('click', openNext);
        $(document).keydown(function (event) {
            if (!openedImage) {
                return;
            }
            if (event.which == 38 || event.which == 40) {
                event.preventDefault();
            }
            if (event.which == 27) {
                close();
            }
            if (event.which == 37 && !openedImage.hasClass('zoom')) {
                openPrevious();
            }
            if (event.which == 39 && !openedImage.hasClass('zoom')) {
                openNext();
            }
        });

        if ($('.gallery a').length == 1) {
            $('.gallery a')[0].addClass('zoom');
        }
        
    })();
    function openPrevious() {
        var prev = openedImage.parent('div').prev();
        if (prev.length == 0) {
            prev = $('.gallery div:last-child');
        }
        prev.find('a').trigger('click');
    }

    function openNext() {
        var next = openedImage.parent('div').next();
        if (next.length == 0) {
            next = $('.gallery div:first-child');
        }
        next.children('a').trigger('click');
    }

    function close(event) {
        if (event) {
            event.preventDefault();
        }
        zoomedIn = false;
        openedImage = null;
        zoom.hide();
        body.removeClass('zoomed');
        zoomContent.empty();
    }

    function changeImageDimensions() {
        windowWidth = $(window).width();
        windowHeight = $(window).height();
    }
    (function bindChangeImageDimensions() {
        $(window).on('resize', changeImageDimensions);
    })();

    //(function bindScrollControl() {
    //    $(window).on('mousewheel DOMMouseScroll', function (event) {
    //        if (!openedImage) {
    //            return;
    //        }
    //        event.stopPropagation();
    //        event.preventDefault();
    //        event.cancelBubble = false;
    //    });
    //})();
};
